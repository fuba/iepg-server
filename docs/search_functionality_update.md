# 検索機能のアップデート（v1.x.x）

## 変更内容

スペース区切りによる検索機能を「OR検索」から「AND検索」に変更しました。

### 変更前
スペース区切りで複数の検索語を入力した場合、それらのいずれかを含む番組が検索結果に表示されていました（OR検索）。
例：`ニュース スポーツ` → ニュースを含む番組 **または** スポーツを含む番組

### 変更後
スペース区切りで複数の検索語を入力した場合、それらのすべてを含む番組のみが検索結果に表示されるようになりました（AND検索）。
例：`ニュース スポーツ` → ニュースとスポーツの両方を含む番組

## 変更理由

より絞り込まれた検索結果を得られるようにするため、スペース区切りの検索をAND条件で実装するように変更しました。これにより、複数のキーワードをすべて含む番組だけを検索できるようになり、ユーザーがより効率的に目的の番組を見つけられるようになります。

## 技術的な変更点

1. `/db/database.go` - SearchPrograms関数でのSQL生成部分を修正
   - 検索語のOR結合を AND結合に変更 (`strings.Join(posConditions, " OR ")` → `strings.Join(posConditions, " AND ")`)

2. `/static/search.html` - 検索UIの説明文を修正
   - 「単語で検索: `ニュース スポーツ` (いずれかを含む)」→「単語で検索: `ニュース スポーツ` (すべてを含む)」

3. `/db/database_test.go` - テストケースの追加
   - AND検索の動作を確認するためのテストケースを追加

## その他の検索機能（変更なし）

以下の機能は変更なく引き続き利用できます：

- フレーズ検索：ダブルクォーテーションで囲むと、その語順で完全に一致するフレーズを検索（例：`"今日のニュース"`)
- 否定検索：単語の前に`-`をつけると、その単語を含まない番組を検索（例：`-スポーツ`）
- 複合検索：上記の検索方法を組み合わせて検索（例：`"特集番組" 野球 -ニュース`）

## APIリファレンスの更新

READMEのAPI仕様セクションを更新し、検索パラメータ`q`の説明をAND検索に修正しました。